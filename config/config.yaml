# GPGFormer Configuration (RGB-only)

dataset:
  name: "image_folder"  # image_folder | custom_json
  root_dir: "/data0/users/Robert/linweiquan/GPGFormer/examples"
  annotation_path: null  # JSON annotation for custom_json
  input_size: [512, 512]  # resize input for detector and MoGe
  img_size: [256, 192]  # model crop size (H, W)
  bbox_scale: 1.2
  use_detector: true
  detector_path: "/data0/users/Robert/linweiquan/GPGFormer/pretrained_model/detection/detector.pt"
  detector_conf: 0.3
  detector_iou: 0.5
  color_factor: 0.2
  color_aug_prob: 0.6
  normalize: "none"  # none | imagenet
  normalize_mean: [0.485, 0.456, 0.406]
  normalize_std: [0.229, 0.224, 0.225]

model:
  img_size: [256, 192]
  patch_size: 16
  embed_dim: 1024
  vit_depth: 24
  vit_num_heads: 16
  mlp_ratio: 4.0
  drop_rate: 0.0
  attn_drop_rate: 0.0
  drop_path_rate: 0.1
  joint_rep_type: "aa"  # aa or 6d
  num_hand_joints: 15
  focal_length: 615.0
  pretrained_wilor: "/data0/users/Robert/linweiquan/GPGFormer/pretrained_model/backbone/wilor_final.ckpt"

moge:
  checkpoint: "Ruicheng/moge-2-vitl-normal"
  num_tokens: 2500
  use_fp16: true

mano:
  model_path: "/data0/users/Robert/linweiquan/GPGFormer/mano_data/MANO_RIGHT.pkl"
  mean_params_path: "/data0/users/Robert/linweiquan/GPGFormer/mano_data/mano_mean_params.npz"
  joint_regressor_extra: null

training:
  num_epochs: 10
  batch_size: 8
  num_workers: 4
  save_dir: "./checkpoints"
  log_dir: "./logs"
  save_freq: 1
  test_freq: 1
  val_split_ratio: 0.1
  log_freq: 50

optimizer:
  type: "AdamW"
  lr: 1.0e-4
  weight_decay: 1.0e-4
  betas: [0.9, 0.999]

scheduler:
  type: "step"  # step | cosine | none
  step_size: 30
  gamma: 0.1
  T_max: 100
  eta_min: 1.0e-6

loss:
  w_pose: 1.0
  w_shape: 0.1
  w_cam: 1.0
  w_2d: 0.0
  w_3d_joint: 0.0

runtime:
  device: "cuda"
