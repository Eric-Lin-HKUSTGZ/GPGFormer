# GPGFormer FreiHAND Configuration (RGB-only)

dataset:
  name: "freihand"
  root_dir: "/data1/users/Robert/datasets/FreiHAND_pub_v2"
  eval_root: "/data1/users/Robert/datasets/FreiHAND_pub_v2_eval"
  img_size: 256
  input_modal: "RGB"
  align_wilor_aug: true
  cube_size: 280
  bbox_scale: 1.2
  use_detector: false
  detector_path: "/data0/users/Robert/linweiquan/GPGFormer/pretrained_model/detection/detector.pt"
  detector_conf: 0.3
  detector_iou: 0.5

model:
  img_size: [256, 256]
  patch_size: 16
  embed_dim: 1024
  vit_depth: 24
  vit_num_heads: 16
  mlp_ratio: 4.0
  drop_rate: 0.0
  attn_drop_rate: 0.0
  drop_path_rate: 0.1
  joint_rep_type: "aa"
  num_hand_joints: 15
  focal_length: 615.0
  pretrained_wilor: "/data0/users/Robert/linweiquan/GPGFormer/pretrained_model/backbone/wilor_final.ckpt"

moge:
  checkpoint: "Ruicheng/moge-2-vitl-normal"
  num_tokens: 2500
  use_fp16: true

mano:
  model_path: "/data0/users/Robert/linweiquan/GPGFormer/mano_data/MANO_RIGHT.pkl"
  mean_params_path: "/data0/users/Robert/linweiquan/GPGFormer/mano_data/mano_mean_params.npz"
  joint_regressor_extra: null

training:
  num_epochs: 50
  batch_size: 16
  num_workers: 8
  save_dir: "./checkpoints/freihand"
  log_dir: "./logs/freihand"
  save_freq: 10
  test_freq: 5
  val_split_ratio: 0.1
  log_freq: 50

optimizer:
  type: "AdamW"
  lr: 5.0e-5
  weight_decay: 0.0001
  betas: [0.9, 0.999]

scheduler:
  type: "cosine"
  T_max: 50
  eta_min: 1.0e-6

augmentation:
  sigma_com: 10.0
  sigma_sc: 0.2
  rot_range: 30.0
  color_factor: 0.2
  aug_prob: 0.8
  color_aug_prob: 0.6
  wilor_trans_factor: 0.02
  wilor_scale_factor: 0.25
  wilor_rot_factor: 30.0
  wilor_rot_aug_rate: 0.6
  wilor_do_flip: false
  wilor_flip_aug_rate: 0.0
  wilor_extreme_crop_aug_rate: 0.0
  wilor_color_scale: 0.2

loss:
  w_pose: 1.0
  w_shape: 0.1
  w_cam: 1.0
  w_2d: 0.01
  w_3d_joint: 0.05

runtime:
  device: "cuda"

logging:
  log_freq: 50
